services:
  # Single image: FastAPI serves frontend SPA + API on port 3000
  scruffy:
    build: .
    container_name: scruffy
    ports:
      - "3000:3000"
    environment:
      - OVERSEERR_URL=${OVERSEERR_URL}
      - OVERSEERR_API_KEY=${OVERSEERR_API_KEY}
      - SONARR_URL=${SONARR_URL}
      - SONARR_API_KEY=${SONARR_API_KEY}
      - RADARR_URL=${RADARR_URL}
      - RADARR_API_KEY=${RADARR_API_KEY}
      - EMAIL_ENABLED=${EMAIL_ENABLED}
      - SMTP_HOST=${SMTP_HOST}
      - SMTP_PORT=${SMTP_PORT}
      - SMTP_USERNAME=${SMTP_USERNAME}
      - SMTP_PASSWORD=${SMTP_PASSWORD}
      - SMTP_FROM_EMAIL=${SMTP_FROM_EMAIL}
      - APP_BASE_URL=${APP_BASE_URL:-http://localhost:3000}
      - API_SECRET_KEY=${API_SECRET_KEY:-change-me-in-production}
      - TZ=America/New_York
      - DATA_DIR=/data
    volumes:
      - ../scruffy_data:/data
    restart: unless-stopped
